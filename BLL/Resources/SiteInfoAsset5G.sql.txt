select  distinct 
SUBSTR(sa.IDNAME, 5, 6) AS SiteID,
ln.NAME AS SiteName, 
'NR' as LAYER_TECHNOLOGY,
sa.ADDRESS1 AS SiteAddress,
SUBSTR(sa.IDNAME, -1) AS Candidate,
antdev.IDNAME AS AntennaType,
CAST ((CASE WHEN la.INHERITMASTERPATTERN = 0 THEN ap.DOWNTILT
WHEN la.INHERITMASTERPATTERN = 1 THEN ap1.DOWNTILT
WHEN la.INHERITMASTERPATTERN = 2 THEN ap2.DOWNTILT
WHEN la.INHERITMASTERPATTERN = 3 THEN ap3.DOWNTILT
WHEN la.INHERITMASTERPATTERN = 4 THEN ap4.DOWNTILT
END) AS INTEGER) AS Etilt,
CAST (pa.PHYINDEX AS DECIMAL(15,10)) AS PHYINDEX,
CAST (pa.AZIMUTH AS DECIMAL(15,10)) AS Azimuth,
CAST (pa.HEIGHT AS DECIMAL(15,10)) AS AGL,
CAST (pa.HEIGHTOFFSET AS DECIMAL(15,10)) AS ARTL,
CAST (pa.TILT AS DECIMAL(15,10)) AS MECHANICAL_TILT,
CAST (lf.FEEDERLEN AS DECIMAL(15,10)) AS FEEDERLENGTH,
f.IDNAME AS FEEDERTYPE,
lc.IDNAME AS CellName,
0 as GSM_TRX,
0 as GSM_Pwr_per_TRX,
0 as UMTS_TRX,
0 as UMTS_Pwr_per_TRX,
0 as LTE_TRX,
0 as LTE_Pwr_per_TRX,
fc.MAXTXPOWER AS NR_Pwr_per_TRX,
1 as NR_TRX,
la.PORTS as PortNumber,
la.INDEXNO as LOGINDEX,
CASE
when substr(fcarrier.idname,4,4)='1800' then 1800
when substr(fcarrier.idname,4,4)='N78' then 3500 
when substr(fcarrier.idname,4,4)='N20' then 800
when substr(fcarrier.idname,4,4)='N28' then 700
when substr(fcarrier.idname,4,4)='2100' then 2100
END AS Band,

 (SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = fcell.LOGCELLFK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = 'RRU type')AS RRU_Type,
(SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = fcell.LOGCELLFK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = 'TMA')AS TMA,
 (SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = fcell.LOGCELLFK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = 'Combiner/Splitter')AS COMBINER_SPLITTER,
 (SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = fcell.LOGCELLFK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = '2nd Combiner')AS SEC_COMBINER_SPLITTER,
 (SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = ln.LOGNODEPK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = 'Co-Location')AS CoLocation,
 (SELECT flg.FLAGID 
                        FROM FLAGS flg
                        JOIN FLAGVALUES flgv ON flgv.OBJECTKEY = fcell.LOGCELLFK AND flg.FLAGKEY = flgv.FLAGKEY AND flgv.PROJECTNO = 1
                        JOIN FLAGGROUPS flgg ON flgg.FLAGGROUPKEY = flgv.FLAGGROUPKEY AND flgg.PROJECTNO = 1
                        WHERE flgg.FLAGGROUPID = 'Antenna Mounting')AS ANTENNA_MOUNT,
CAST (fcell.CELLID AS DECIMAL(20,10)) AS CellID	,
substr(CAST (fcell.CELLID AS DECIMAL(20,10)), 5,1 ) AS Sector	
FROM SITEADDRESS sa
JOIN LOGNODE ln ON sa.ADDRESSKEY = ln.ADDRESSFK AND ln.PROJECTNO = 1
JOIN LOGCELL lc ON lc.LOGNODEFK = ln.LOGNODEPK  AND ln.LOGNODETYPEFK=LC.LOGNODETYPEFK AND lc.PROJECTNO = 1	
JOIN FIVEGCELLPARAMS fcell ON fcell.LOGCELLFK = lc.LOGCELLPK  AND fcell.PROJECTNO = 1	
JOIN FIVEGCELLCAR fc ON lc.logcellpk=fc.LOGCELLFK  AND fc.PROJECTNO = 1
JOIN LOGCELLFEEDER lf ON  fcell.LOGCELLFK=lf.logcellfk  AND lf.PROJECTNO = 1
JOIN FEEDER f ON lf.FEEDERFK=f.FEEDERKEY
JOIN LOGICALANTENNA la ON la.LOGANTENNAPK=lf.LOGANTENNAFK AND la.PROJECTNO = 1
JOIN PHYANTENNA pa ON pa.PHYANTENNAPK=la.PHYANTENNAFK AND pa.PROJECTNO = 1
JOIN ANTENNADEVICE antdev ON pa.DEVICEFK=antdev.DEVICEPK AND antdev.PROJECTNO = 1	

JOIN ANTENNAPATTERN ap ON la.anttypefk = ap.PATTERNPK AND ap.PROJECTNO = 1
JOIN ANTENNAPATTERN ap1 ON ap1.PATTERNPK = pa.MASTERPATTERN1FK AND ap1.PROJECTNO = 1
JOIN ANTENNAPATTERN ap2 ON ap2.PATTERNPK = pa.MASTERPATTERN2FK AND ap2.PROJECTNO = 1
JOIN ANTENNAPATTERN ap3 ON ap3.PATTERNPK = pa.MASTERPATTERN3FK AND ap3.PROJECTNO = 1
JOIN ANTENNAPATTERN ap4 ON ap4.PATTERNPK = pa.MASTERPATTERN4FK AND ap4.PROJECTNO = 1

JOIN ANTENNADEVICE antdev ON pa.DEVICEFK=antdev.DEVICEPK AND antdev.PROJECTNO = 1
JOIN FIVEGNODECAR fnode ON  fc.CARRIERFK=fnode.CARRIERPK AND fnode.PROJECTNO = 1	
JOIN fivegcarrier fcarrier ON fnode.CONFIGCARRIERFK=fcarrier.CARRIERKEY AND fcarrier.PROJECTNO = 1

INNER JOIN network_planning.FLAGVALUES z ON ln.projectno = z.projectno AND ln.lognodepk = z.objectkey 
INNER JOIN network_planning.FLAGS y ON y.PROJECTNO = z.PROJECTNO AND y.FLAGGROUPKEY = z.FLAGGROUPKEY AND y.FLAGKEY = z.FLAGKEY 
INNER JOIN network_planning.FLAGGROUPS x ON x.PROJECTNO = y.PROJECTNO AND x.FLAGGROUPKEY = y.FLAGGROUPKEY
INNER JOIN network_planning.FLAGVALUES z1 ON lc.projectno = z1.projectno AND lc.logcellpk = z1.objectkey 
INNER JOIN network_planning.FLAGS y1 ON y1.PROJECTNO = z.PROJECTNO AND y1.FLAGGROUPKEY = z1.FLAGGROUPKEY AND y1.FLAGKEY = z1.FLAGKEY 
INNER JOIN network_planning.FLAGGROUPS x1 ON x1.PROJECTNO = y1.PROJECTNO AND x1.FLAGGROUPKEY = y1.FLAGGROUPKEY

where 

(x.flaggroupid = 'Candidate')  AND (y.flagid ='Accepted') 
AND (x1.flaggroupid = 'Site Progress') 
--AND (y1.flagid ='On Air') 
AND (ln.PROJECTNO = 1) 
AND SUBSTR(sa.IDNAME, 1, 20) like '%@@@@@@%'